[回到首页](../README.md)

# 1. 设计模式

常见设计模式及项目中的应用

[TOC]

## 1.1. 常见设计模式

**单例模式**：使某个类的对象只允许创建一个

**简单工厂模式**：使用工厂方法或工厂类来生成对象，而不是在代码中直接new

**策略模式**：将一组特定的行为和算法封装成类，以适应某些特定的上下文环境

**观察者模式**：当一个对象状态发生改变时，依赖它的对象全部会收到通知，并自动更新。观察者模式实现了低耦合，非侵入式的通知与更新机制

代理模式：在客户端与实体之间建立一个代理对象（proxy），客户端对实体进行的操作全部委派给代理对象，隐藏实体的具体实现细节

装饰器模式：可以动态修改类的功能

**适配器模式**：将截然不同的函数接口封装成统一的API

**注册器模式**：全局共享和交换对象

命令模式

组合模式

模板方法模式

数据对象映射模式：将对象和数据存储映射起来，对一个对象的操作会映射为对数据存储的操作

原型模式：先创建好一个原型对象，然后通过clone原型对象来创建新的对象，减少new对象时初始化的开销，适用于大对象

迭代器模式：在不需要了解内部实现的前提下，遍历一个聚合对象的内部元素



课程：[大话PHP设计模式](https://www.imooc.com/learn/236)

博客：[《汪春波-php技术博客-设计模式》](https://learnku.com/docs/shxdledu)

## 1.2. 设计模式在实际产品中的应用

2.1、单例模式：CI2中数据库实例、配置类

2.2、工厂模式：CI2中数据库DB方法，根据参数返回不同的数据库驱动实例，比如pdo、mysqli、sqlite等

2.3、注册器模式：CI2中的Loader，一次加载随处可用；TP中的Container

2.4、适配器模式：只在初始化时不同（不同的类或相同类但参数不同），完了接口都是一致的

缓存类，底层可以是file、yac、redis；CI2数据库CI_DB_driver类，底层可以是pdo、mysqli、sqlite等

2.5、策略模式：

2.6、数据对象映射模式：ORM

2.7、观察者模式：CI和TP中的钩子，请求前校验参数，请求后记录日志

2.8、装饰器模式：TP中的中间件（原理是闭包），可以改变类的输入输出

2.9、代理模式：可实现数据库的读写分离

2.10、外观模式：对企业微信sdk的封装，系统直接调用发送消息的接口

## 1.3. 面向对象编程的基本原则

3.1、单一职责：一个类，只需要做好一件事情

3.2、开放封闭：一个类，应该是可以扩展的，而不应通过修改来增加功能

3.3、依赖倒置：一个类，不应该强依赖另外一个类。每个类对于另外一个类都是可替换的

3.4、配置化：尽可能使用配置，而不是硬编码

3.5、面向接口编程：只需要关心接口，不需要关心实现

